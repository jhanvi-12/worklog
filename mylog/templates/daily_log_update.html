{% extends 'base.html' %}
{% load rest_framework %}
{% load static %}
{% block content %}
<form method="post" action="{% url 'mylog:logout' %}">
    {% csrf_token %}
    <input type="submit" value="Logout">
</form>

<div class="container-flex" xmlns="http://www.w3.org/1999/html">
    <section class="" style="background-color:#45435c4f;">
        <div class="container">
            <h3 class="fw-bold fst-italic text-center">{{ user.username }}, Please update your daily work sheet.</h3>
            <div class="form-control mb-3" style="border-radius:30px;">
                <h4 class="fw-bold fs-4 mb-3 text-center text-uppercase">If You do not have any project related task, Please add manually.</h4>
                <button type="button" class="btn d-grid col-6 mx-auto mt-3" data-bs-toggle="modal"
                    data-bs-target="#addTaskModal" onclick="addTask({{user.id}})">
                <img src="{% static 'images/plus_tab.png' %}" style="width:40px;">
                </button>
            </div>
            <form method="post" class="mt-3" id="logForm">
              {% csrf_token %}
                <div class="mb-3" id="user-{{user.id}}">
                    <div class="form-control fw-bold fs-5 mb-3 text-uppercase" id="user_id" style="border-radius:30px; text-align:left;">
                        {{ user }}
                    </div>
                    <div class="form-control fw-bold fs-5 mb-3 text-uppercase project-name" id="project" style="border-radius:30px;">
                        <select id="id_project_name" name="project_name">
                            {% for project in serializer.fields.project_name.queryset %}
                                <option value="{{ project.id }}">{{ project.project_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="form-control fw-bold fs-5 mb-3 text-uppercase" id="form-task" style="border-radius:30px;">
                        <select id="id_task" name="task"></select>
                    </div>

                    <div class="form-control fw-bold fs-5 mb-3 text-uppercase" id="date" style="border-radius:30px;">
                        {% render_field serializer.date style=style %}
                    </div>
                    <div class="form-control fw-bold fs-5 mb-3 text-uppercase" id="form-description" style="border-radius:30px;">
                        {% render_field serializer.description style=style %}
                    </div>
                    <div class="row">
                        <div class="col">
                            <div class="form-control fw-bold fs-5 text-uppercase" id="start_time" style="border-radius:30px;">
                                {% render_field serializer.start_time style=style %}
                            </div>
                        </div>
                        <div class="col">
                             <div class="form-control fw-bold fs-5 text-uppercase" id="end_time" style="border-radius:30px;">
                                {% render_field serializer.end_time style=style %}
                            </div>
                        </div>
                    </div>
                    <!-- submit button div starts -->
                    <div class="d-grid col-6 mx-auto">
                        <button type="submit" class="btn btn-primary btn-lg btn-block" onclick="validate()">SUBMIT FORM</button>
                    </div>
                    <!-- submit button ends -->
                  </div>
            </form>
            <!-- Add task modal starts -->
            <div class="modal fade" id="addTaskModal" tabindex="-1" aria-labelledby="addTaskModalLabel" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title text-uppercase" id="addTaskModalLabel">Add Daily log</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body">
                    <form>
                        <div class="col fw-bold fs-5">
                        <label for="user" class="col-form-label">User :</label>
                        <input type="text" class="form-control" id="form-user" value="{{user.username}}">
                        </div>
                        <div class="col fw-bold fs-5">
                        <label for="project" class="col-form-label">Project Name :</label>
                        <input type="text" class="form-control" id="form-project">
                        </div>
                      <div class="col fw-bold fs-5">
                        <label for="date" class="col-form-label">Date :</label>
                        <input type="date" class="form-control" id="form-date">
                      </div>
                        <div class="col fw-bold fs-5">
                        <label for="task" class="col-form-label">Task title :</label>
                        <input type="text" class="form-control" id="task-name">
                      </div>
                      <div class="col fw-bold fs-5">
                        <label for="description" class="col-form-label">Description :</label>
                        <textarea class="form-control" id="description-text"></textarea>
                      </div>
                        <div class="row">
                            <div class="col fw-bold fs-5">
                                <label for="start" class="col-form-label">Start Time :</label>
                                <input type="time" class="form-control" id="start-time">
                            </div>
                            <div class="col fw-bold fs-5">
                                <label for="end" class="col-form-label">End Time:</label>
                                <input type="time" class="form-control" placeholder="hrs:min" id="end-time">
                          </div>
                        </div>

                    </form>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                    <button type="button" class="btn btn-primary" onclick="saveDailyLog()">Save</button>
                  </div>
                </div>
              </div>
            </div>
            <!-- Add task modal ends -->
        </div>
</section>
</div>

{% endblock %}
{% block extra_js %}
<script type="text/javascript">
{% for key, value in errors.items %}
    alertify.error("{{ key }}: {{ value|join:', ' }}");
{% endfor %}
</script>
<script type="text/javascript" src="{% static 'js/user.js' %}"></script>
{% endblock extra_js %}